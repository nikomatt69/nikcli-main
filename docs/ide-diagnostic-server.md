# IDE Diagnostic Integration in NikCLI\n\nNikCLI provides built-in diagnostic capabilities through CLI commands and package.json scripts, enabling project analysis, linting, testing, and status checks. These are integrated into workflows via the Universal Agent and tools like analyze_project.\n\n## Overview\n\nDiagnostics auto-detect project type (Node.js/TS via package.json) and run relevant tools:\n\n- **Build**: TSC compilation (`pnpm build`).\n- **Linting**: Biome (`pnpm lint`/`format`/`check`).\n- **Testing**: Vitest (`pnpm test`/`test:run`/`watch`).\n- **Version Control**: Git status via /vcs commands.\n- **Dependencies**: Analysis via /analyze-project (metrics, deps, security).\n- **Package Managers**: npm/yarn/pnpm/bun (auto-detected via engines).\n\nNo dedicated MCP server; diagnostics use CLI commands and agent tools.\n\n## Available CLI Commands\n\n### Core Diagnostics\n\n- **/analyze-project**: Comprehensive analysis (metrics, deps, security scan).\n - Example: `/analyze-project` → Returns project type, deps count (e.g., 93 prod + 22 dev), scripts.\n\n- **/health**: Quick project health check (build, lint, test status).\n - Returns: Success/fail summary, errors/warnings.\n\n- **/diag status**: Overview of current issues (lint/test).\n\n### Build & Analysis\n\n- **Build Check**: `/build run` or `pnpm build` (TSC via tsconfig.cli.json).\n - Returns: Exit code, errors (e.g., type issues).\n\n- **Lint Run**: `/lint run` or `pnpm lint` (Biome on src/).\n - Returns: Errors/warnings count, file list.\n\n- **Test Run**: `/test run` or `pnpm test` (Vitest).\n - Returns: Passed/failed/skipped, coverage.\n\n### Version Control\n\n- **/vcs status**: Git status (branch, changes).\n - Returns: Branch (e.g., main), staged/unstaged files.\n\n- **/vcs diff**: Git diff for file/path.\n - Returns: Unified diff output.\n\n### Runtime & Project Tools\n\n- **/runtime logs**: View app logs (via winston logger).\n - Parameters: lines=100.\n - Returns: Timestamped logs (error/info).\n\n- **/graph project**: Dependency graph (from package.json).\n - Returns: Nodes/edges for deps (e.g., ai-sdk/\* → anthropic).\n\n## Auto-Detection Logic\n\n- **Build**: Detects tsconfig.json → `tsc --project tsconfig.cli.json`.\n- **Lint**: Detects biome.json → `biome lint src/`.\n- **Test**: Detects vitest → `vitest run`.\n- **VCS**: Git repo → standard git commands.\n- **Package Mgr**: Engines in package.json (npm/yarn/pnpm/bun priority).\n\n## Integration with Workflows\n\n- **Agent Commands**: `/auto 'run diagnostics'` triggers full check.\n- **Background Agents**: Use nikctl for async diagnostics (e.g., `nikctl bg start --task 'lint and test'`).\n- **Scripts**: Run `pnpm system:diagnose` for env info (Node version, platform).\n\n## Environment Variables\n\n- `NIKCLI_PACKAGE_MANAGER=npm` (force mgr).\n- `NODE_ENV=development` (for scripts).\n\n## Examples\n\n`bash\n# Health check\n/health\n\n# Lint and test\n/lint run\n/test run\n\n# Project analysis\n/analyze-project\n\n# VCS status\n/vcs status\n`\n\n## Security & Performance\n\n- **Timeouts**: 30s default for commands.\n- **Sandbox**: No network in diagnostics; local only.\n- **Cache**: Vitest/Biome incremental.\n\n**Note**: Aligned to v0.2.3 codebase (no MCP; uses CLI/agent tools). For advanced diagnostics, extend via custom scripts.
